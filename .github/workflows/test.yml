name: 🧪 Run tests and capture metrics
  run: 
    mkdir -p test-results
    docker run --rm \
      -v ${{ github.workspace }}/test-results:/app/test-results \
      my-app:test \
      sh -c "npm test -- --reporters=default --reporters=jest-junit && cat junit.xml > /app/test-results/test-report.xml"

- name: 🔍 Debug test-results directory
  run: ls -l test-results/

- name: 📝 Publicar resultados de tests
  if: always()
  uses: actions/upload-artifact@v3
  with:
    name: test-reports
    path: test-results/
